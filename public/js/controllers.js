// Generated by CoffeeScript 1.6.2
'use strict';angular.module('gottaGo.controllers', ['ngResource']).controller('GGMainCtrl', function($scope, Status, Que, roomNames, $timeout) {
  var getQue;

  $scope.floorsArray = [];
  $scope.que = [];
  $scope.floor = {};
  $scope.notify = {};
  $scope.milliseconds = function(stamp) {
    debugger;    return Date.parse(stamp).getTime();
  };
  $scope.getRoomNames = function(floor, room) {
    return roomNames[floor + room];
  };
  getQue = function() {
    var floor, _i, _len, _ref, _results;

    $scope.que = [];
    _ref = $scope.floorsArray;
    _results = [];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      floor = _ref[_i];
      _results.push(Que.get(floor[0].floor).success(function(response) {
        return $scope.que.push(response.length);
      }));
    }
    return _results;
  };
  setInterval(function() {
    return Status.get().success(function(response) {
      $scope.floorsArray = response;
      return getQue();
    });
  }, 2000);
  return $scope.addToQue = function(floor, contact) {
    return Que.post(floor, {
      contact: contact
    }).success(function(response) {
      $scope.notify[floor] = 'qued';
      return getQue();
    });
  };
});
